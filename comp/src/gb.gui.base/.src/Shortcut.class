' Gambas class file

Export

Static Public Sub _call(Text As String, Shortcut As String) As String

  Dim iPos As Integer
  
  iPos = String.InStr(Text, "&")
  If iPos Then 
    Shortcut = String.Mid$(Text, iPos + 1, 1)
    Text = Left(Text, iPos - 1) & Mid$(Text, iPos + 1)
  Endif
  
  iPos = InStr(Text, Shortcut, 1, gb.IgnoreCase)
  If iPos = 0 Then Return Text '& " (&" & String.UCase(Shortcut) & ")"
  Return Left(Text, iPos - 1) & "&" & Mid$(Text, iPos)
  
End

